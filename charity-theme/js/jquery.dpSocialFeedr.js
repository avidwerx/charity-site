(function(a){a.fn.dpSocialFeedr=function(b){function U(a){if(R[a].name!=""){for(var b=0;b<R[a].url.length;b++){X(R[a].url[b],b,function(b,c){if(!b){return false}for(var d=0;d<b.entries.length;d++){b.entries[d].favicon=R[a].favicon;T.push(b.entries[d])}if(c==R[a].url.length-1){if(parseInt(a,10)==R.length-1){W()}else{U(a+1)}}},o)}}else{if(parseInt(a,10)==R.length-1){W()}else{U(a+1)}}}function V(){U(0)}function W(){var b=false,c=false,d,e,f,g,h,i,j,k,l;a(S).removeClass("dpSocialFeedrLoading");d=a("<ul>").addClass("dpSocialFeedr");T.sort(function(a,b){a=(new Date(a["publishedDate"])).getTime();b=(new Date(b["publishedDate"])).getTime();return a==b?0:a>b?-1:1});for(x in T){if(x>=o)break;if(q){f=a("<img />").attr({alt:"",src:T[x].favicon,width:"16",height:"16"}).addClass("icon")}else{f=""}h=a("<span />").addClass("time").html(Y((new Date(T[x].publishedDate)).getTime()));i=a("<a />").addClass("permalink").attr({href:T[x].link,target:"_blank"}).html("â†’");if(T[x].link.substr(0,28)=="http://www.youtube.com/watch"){b=true;c=false;j=a("<div />").addClass("video_icon")}else if(T[x].link.substr(0,16)=="http://vimeo.com"){b=false;c=true;j=a("<div />").addClass("video_icon")}else{b=false;c=false;j=""}g=a("<div />").addClass("dpSocialFeedrContent").append(a(h)).append(a(i)).append(a("")).append(bb(T[x].title));if(Z(T[x].content,T[x].title,false)!=""){k=Z(T[x].content,T[x].title,false);l=a("<a />").attr({href:T[x].link,target:"_blank"}).addClass("img_link"+(b||c?" youtube":""));a(l).append(k).append(j);if(v){a(l).addClass("dpSocialFeedrColorbox");if(b){a(l).attr({href:_(T[x].link)})}else if(c){a(l).attr({href:ab(T[x].link)})}else{a(l).attr({href:Z(T[x].content,T[x].title,true)})}}g.append(a("<br />")).append(l)}g.append("<div style='clear: both;'></div>");e=a("<li class='blackgradient'>").append(a(f)).append(a(g)).append("<div class='streamshadow'></div>");a(d).append(e)}a(S).append(d);if(p=="fade"){if(u){a(d).bxSlider({auto:true,mode:"fade",controls:false,speed:r,pause:s,autoHover:t,onBeforeSlide:function(b,c,e){jQuery(a(d).parent(".bx-window")).animate({height:jQuery(a(d).find("li")[b]).outerHeight()},950)},onAfterSlide:function(b,c,e){if(b=="0"){jQuery(a(d).parent(".bx-window")).animate({height:jQuery(a(d).find("li")[b]).outerHeight()},950)}}})}else{a(d).bxSlider({auto:true,mode:"fade",controls:false,speed:r,pause:s,autoHover:t})}}if(v){a(d).find(".dpSocialFeedrColorbox").colorbox();a(d).find(".dpSocialFeedrColorbox.youtube").colorbox({iframe:true,innerWidth:425,innerHeight:344})}}function X(b,c,d,e){if(b==null)return false;var f="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(b);if(e!=null)f+="&num="+e;a.getJSON(f,function(a){if(typeof d=="function")d.call(this,a.responseData.feed,c);else return false})}function Y(a){var b=a;var c=arguments.length>1?arguments[1]:new Date;var d=parseInt((c.getTime()-b)/1e3);d=d+c.getTimezoneOffset()*60;var e="";if(d<60){e="less than minute ago"}else if(d<120){e="about a minute ago"}else if(d<60*60){e="about "+parseInt(d/60).toString()+" minutes ago"}else if(d<120*60){e="about an hour ago"}else if(d<24*60*60){e="about "+parseInt(d/3600).toString()+" hours ago"}else if(d<48*60*60){e="1 day ago"}else{e=parseInt(d/86400).toString()+" days ago"}return e}function Z(a,b,c){var d=new Array;var e=/<img .*src=["\']([^ ^"^\']*)["\']/gi;var f;while(f=e.exec(a)){d.push(f[1])}if(d.length>0){var g=d[0];g=g.replace("_m.jpg",".jpg");g=g.replace("_s.jpg","_b.jpg");if(g.indexOf("safe_image.php")!=-1){g=unescape(g.match(/url=([^&]+)/)[1])}if(c){return g}else{return'<img src="'+g+'" alt="'+b+'" height="100" />'}}else{return false}}function _(a){return a.replace(/http:\/\/(www.)?(youtu.be\/|youtube.com\/watch\?v=)([a-zA-Z0-9?%.;:\\/=+_-]+)([&]*([a-zA-Z0-9?&%.;:\\/=+_-]*))/i,"http://www.youtube.com/v/$3?fs=1&hl=en_US")}function ab(a){return a.replace(/http:\/\/(www.)?(vimeo.com\/)([a-zA-Z0-9?%.;:\\/=+_-]+)([&]*([a-zA-Z0-9?&%.;:\\/=+_-]*))/i,"http://player.vimeo.com/video/$3")}function bb(a){return a.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/,function(a){return a.link(a)})}var c;c=a.extend({},a.fn.dpSocialFeedr.defaults,b);var d=c.twitter,e=c.facebook_page,f=c.delicious,g=c.flickr,h=c.tumblr,j=c.youtube,k=c.dribbble,l=c.digg,m=c.pinterest,n=c.vimeo,o=c.total,p=c.displayStyle,q=c.showIcons,r=c.fadeSpeed,s=c.feedPause,t=c.fadeAutohover,u=c.fadeAutoheight,v=c.addColorbox,w=d.split(","),y=new Array,z=e.split(","),A=new Array,B=f.split(","),C=new Array,D=g.split(","),E=new Array,F=h.split(","),G=new Array,H=j.split(","),I=new Array,J=k.split(","),K=new Array,L=l.split(","),M=new Array,N=m.split(","),O=new Array,P=n.split(","),Q=new Array,R=new Array,S=a(this),T=new Array;for(i=0;i<w.length;i++){y[i]="http://twitter.com/statuses/user_timeline/"+a.trim(w[i])+".rss"}for(i=0;i<z.length;i++){A[i]="http://www.facebook.com/feeds/page.php?id="+a.trim(z[i])+"&format=atom10"}for(i=0;i<B.length;i++){C[i]="http://feeds.delicious.com/v2/rss/"+a.trim(B[i])}for(i=0;i<D.length;i++){E[i]="http://api.flickr.com/services/feeds/photos_public.gne?id="+a.trim(D[i])+"&format=rss_200"}for(i=0;i<F.length;i++){G[i]="http://"+a.trim(F[i])+".tumblr.com/rss"}for(i=0;i<H.length;i++){I[i]="http://gdata.youtube.com/feeds/base/users/"+a.trim(H[i])+"/uploads"}for(i=0;i<J.length;i++){K[i]="http://dribbble.com/players/"+a.trim(J[i])+"/shots.rss"}for(i=0;i<L.length;i++){M[i]="http://digg.com/users/"+a.trim(L[i])+"/history.rss"}for(i=0;i<N.length;i++){O[i]="http://www.pinterest.com/"+a.trim(N[i])+"/feed.rss"}for(i=0;i<P.length;i++){Q[i]="http://vimeo.com/"+a.trim(P[i])+"/videos/rss"}R[0]={name:d,url:y,favicon:directory+"/images/twitterstream-icon.png"};R[1]={name:e,url:A,favicon:directory+"/images/fbstream-icon.png"};R[2]={name:f,url:C,favicon:"http://www.delicious.com/favicon.ico"};R[3]={name:g,url:E,favicon:"http://www.flickr.com/favicon.ico"};R[4]={name:h,url:G,favicon:"http://www.tumblr.com/favicon.ico"};R[5]={name:j,url:I,favicon:"http://www.youtube.com/favicon.ico"};R[6]={name:k,url:K,favicon:"http://www.dribbble.com/favicon.ico"};R[7]={name:l,url:M,favicon:"http://www.digg.com/favicon.ico"};R[8]={name:m,url:O,favicon:"http://www.pinterest.com/favicon.ico"};R[9]={name:n,url:Q,favicon:"http://www.vimeo.com/favicon.ico"};this.addClass("dpSocialFeedrLoading");V()};a.fn.dpSocialFeedr.defaults={twitter:"",facebook_page:"",delicious:"",flickr:"",tumblr:"",youtube:"",dribbble:"",digg:"",pinterest:"",vimeo:"",displayStyle:"list",showIcons:true,fadeSpeed:600,feedPause:5e3,fadeAutohover:false,fadeAutoheight:true,addColorbox:false,total:10}})(jQuery)